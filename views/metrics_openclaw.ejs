<%- include('partials/header') %>

<h1>Metrics (OpenClaw)</h1>

<div class="panel">
  <div class="muted">This view is pulled from <span class="mono">openclaw sessions --json</span>. Token totals are per-session.</div>
  <div class="hint">Filter: <a class="btn" href="/metrics/openclaw">All</a> <a class="btn" href="/metrics/openclaw?active=120">Active 120m</a> <a class="btn" href="/metrics/openclaw?active=1440">Active 24h</a></div>
</div>

<% if (err) { %>
  <div class="flashes"><div class="flash error"><%= err %></div></div>
<% } %>

<div class="panel">
  <table>
    <thead>
      <tr>
        <th>Session key</th>
        <th>Kind</th>
        <th>Model</th>
        <th>Total tokens</th>
        <th>Input</th>
        <th>Output</th>
        <th>Updated</th>
      </tr>
    </thead>
    <tbody>
      <% for (const s of sessions) { %>
        <tr>
          <td class="mono"><%= s.key %></td>
          <td><%= s.kind || '' %></td>
          <td class="mono"><%= s.model || '' %></td>
          <td class="mono"><%= Number(s.totalTokens || 0).toLocaleString() %></td>
          <td class="mono"><%= Number(s.inputTokens || 0).toLocaleString() %></td>
          <td class="mono"><%= Number(s.outputTokens || 0).toLocaleString() %></td>
          <td class="mono"><%= s.updatedAt ? new Date(s.updatedAt).toISOString() : '' %></td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>

<%- include('partials/footer') %>
